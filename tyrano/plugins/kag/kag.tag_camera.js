tyrano.plugin.kag.tag.camera={vital:[],pm:{time:1e3,from_x:"0",from_y:"0",from_zoom:"1",from_rotate:"0",x:"",y:"",zoom:"",rotate:"",layer:"layer_camera",wait:"true",ease_type:"ease"},start:function(a){var t=this,e=a.time+"ms";void 0===this.kag.stat.current_camera[a.layer]&&(this.kag.stat.current_camera[a.layer]={x:"0",y:"0",scale:"1",rotate:"0"});var r=$.extend(!0,{},this.kag.stat.current_camera[a.layer]);""!=a.x&&(r.x=-1*parseInt(a.x)+"px"),""!=a.y&&(r.y=1*parseInt(a.y)+"px"),""!=a.zoom&&(r.scale=a.zoom),""!=a.rotate&&(r.rotate=a.rotate+"deg"),"0"==a.from_x&&"0"==a.from_y&&"1"==a.from_zoom&&"0"==a.from_rotate||(this.kag.stat.current_camera[a.layer]={x:-1*parseInt(a.from_x)+"px",y:1*parseInt(a.from_y)+"px",scale:a.from_zoom,rotate:a.from_rotate+"deg"});var n=!1;t.kag.stat.is_move_camera=!0;var i={frames:{"0%":{trans:this.kag.stat.current_camera[a.layer]},"100%":{trans:r}},config:{duration:e,state:"running",easing:a.ease_type},complete:function(){"true"==a.wait&&0==n?(n=!0,setTimeout(function(){t.kag.ftag.nextOrder()},300)):1==t.kag.stat.is_wait_camera&&(t.kag.stat.is_wait_camera=!1,t.kag.ftag.nextOrder()),t.kag.stat.is_move_camera=!1}};this.kag.stat.current_camera[a.layer]=r,"false"==a.wait&&t.kag.ftag.nextOrder(),"layer_camera"==a.layer?($(".layer_camera").css("-webkit-transform-origin","center center"),$(".layer_camera").a3d(i),this.kag.stat.current_camera_layer=""):($("."+a.layer+"_fore").css("-webkit-transform-origin","center center"),$("."+a.layer+"_fore").a3d(i),this.kag.stat.current_camera_layer=a.layer)},play:function(a,t){}},tyrano.plugin.kag.tag.reset_camera={vital:[],pm:{time:1e3,wait:"true",ease_type:"ease",layer:"layer_camera"},start:function(a){var t=this;parseInt(a.time)<10&&(a.time=10);var e=a.time+"ms",r=!1;t.kag.stat.is_move_camera=!0;var n={frames:{"0%":{trans:this.kag.stat.current_camera[a.layer]},"100%":{trans:{x:"0px",y:"0px",scale:"1",rotate:"0deg"}}},config:{duration:e,state:"running",easing:a.ease_type},complete:function(){$("."+a.layer).css({"-animation-name":"","-animation-duration":"","-animation-play-state":"","-animation-delay":"","-animation-iteration-count":"","-animation-direction":"","-animation-fill-mode":"","-animation-timing-function":"",transform:""}),"true"==a.wait&&0==r?(r=!0,t.kag.ftag.nextOrder()):1==t.kag.stat.is_wait_camera&&(t.kag.stat.is_wait_camera=!1,t.kag.ftag.nextOrder()),t.kag.stat.is_move_camera=!1}};"layer_camera"!=a.layer?delete this.kag.stat.current_camera[a.layer]:this.kag.stat.current_camera={},"false"==a.wait&&t.kag.ftag.nextOrder(),"layer_camera"==a.layer?($(".layer_camera").css("-webkit-transform-origin","center center"),$(".layer_camera").a3d(n),this.kag.stat.current_camera_layer=""):($("."+a.layer+"_fore").css("-webkit-transform-origin","center center"),$("."+a.layer+"_fore").a3d(n),this.kag.stat.current_camera_layer="")},play:function(a,t){}},tyrano.plugin.kag.tag.wait_camera={start:function(a){1==this.kag.stat.is_move_camera?this.kag.stat.is_wait_camera=!0:this.kag.ftag.nextOrder()}},tyrano.plugin.kag.tag.mask={vital:[],pm:{time:1e3,effect:"fadeIn",color:"0x000000",graphic:"",folder:""},start:function(a){var t=this;t.kag.layer.hideEventLayer();var e=$("<div class='layer layer_mask' data-effect='"+a.effect+"' style='z-index:100000000;position:absolute;'>");e.css("animation-duration",parseInt(a.time)+"ms");var r=parseInt(t.kag.config.scWidth),n=parseInt(t.kag.config.scHeight);if(e.css({width:r,height:n}),"none"==a.color?e.css("background-color",""):e.css("background-color",$.convertColor(a.color)),""!=a.graphic){""!=a.folder?folder=a.folder:folder="image";var i="";""!=a.graphic&&(i="./data/"+folder+"/"+a.graphic,e.css("background-image","url("+i+")"))}$(".tyrano_base").append(e);e.addClass("animated "+a.effect).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t.kag.ftag.nextOrder()})}},tyrano.plugin.kag.tag.mask_off={vital:[],pm:{time:1e3,effect:"fadeOut"},start:function(a){var t=this,e=$(".layer_mask");if(e.get(0)){var r=e.attr("data-effect");e.removeClass("animated "+r),e.css("animation-duration",parseInt(a.time)+"ms");e.addClass("animated "+a.effect).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.remove(),t.kag.layer.showEventLayer(),t.kag.ftag.nextOrder()})}else t.kag.layer.showEventLayer(),t.kag.ftag.nextOrder()}};
